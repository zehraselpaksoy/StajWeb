@model List<ECommerceProject.Entities.Concrete.CartItem>
@using System.Globalization

@if (Model == null || !Model.Any())
{
    <div class="alert alert-info text-center">
        Sepetiniz boş.
    </div>
}
else
{
    <table class="table table-hover table-bordered mt-3">
        <thead class="table-light">
            <tr>
                <th scope="col">Ürün</th>
                <th scope="col" style="width:100px;">Fiyat</th>
                <th scope="col" style="width:100px;">Adet</th>
                <th scope="col" style="width:130px;">İşlem</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        <div class="d-flex align-items-center">
                            <img src="@(string.IsNullOrEmpty(item.Product?.ImageUrl) ? "https://placehold.co/50x50?text=Resim" : Url.Content(item.Product.ImageUrl))"
                                 alt="@item.Product?.Name"
                                 class="me-2 rounded"
                                 style="width: 50px; height: 50px; object-fit: cover;"
                                 onerror="this.onerror=null;this.src='https://placehold.co/50x50?text=Resim';">
                            <div>
                                <strong>@(item.Product?.Name ?? "Bilinmeyen Ürün")</strong><br />
                                <small class="text-muted">@(item.Product?.Description?.Length > 30 ? item.Product.Description.Substring(0, 30) + "..." : item.Product?.Description)</small>
                            </div>
                        </div>
                    </td>
                    <td class="align-middle">
                        @item.UnitPrice.ToString("C", new System.Globalization.CultureInfo("tr-TR"))
                    </td>
                    <td class="align-middle text-center">
                        @item.Quantity
                    </td>
                    <td class="align-middle text-center">
                        <div class="btn-group btn-group-sm" role="group">
                            <a href="@Url.Action("DecreaseQuantity", "Home", new { id = item.ProductId })"
                               class="btn btn-outline-secondary btn-quantity-change" title="Azalt">-</a> @* btn-quantity-change eklendi *@
                            <a href="@Url.Action("IncreaseQuantity", "Home", new { id = item.ProductId })"
                               class="btn btn-outline-secondary btn-quantity-change" title="Arttır">+</a> @* btn-quantity-change eklendi *@
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="d-flex justify-content-between align-items-center mt-3">
        <strong>Toplam Tutar:</strong>
        <span class="fs-5 fw-bold text-primary">
            @Model.Sum(x => x.TotalPrice).ToString("C", new System.Globalization.CultureInfo("tr-TR"))
        </span>
    </div>

    <div class="mt-3 text-end">
        <a href="@Url.Action("ClearCart", "Home")" class="btn btn-danger btn-sm btn-clear-cart">
            @* onclick kaldırıldı, btn-clear-cart eklendi *@
            Sepeti Temizle
        </a>
    </div>
}
